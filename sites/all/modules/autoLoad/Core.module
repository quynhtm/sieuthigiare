<?php
/*
* @Created by: HSS
* @Author	 : nguyenduypt86@gmail.com
* @Date 	 : 06/2014
* @Version	 : 1.0
*/
/**
 * Implements hook_menu().
 */
function Core_menu() {
    $items["page-403"] = array(
        "title" => t("page access denied"),
        "description" => t("page access denied"),
        'page callback' => 'page_403',
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );
    $items["page-404"] = array(
        "title" => t("page not found"),
        "description" => t("page not found"),
        'page callback' => 'page_404',
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );
    $items["ajax"] = array(
        "title" => t("Ajax"),
        "description" => t("Ajax"),
        'page callback' => 'CoreAjax',
        'access callback' => TRUE,
        'type' => MENU_CALLBACK,
    );
  return $items;
}
function Core_theme() {
    return array(
        'page_403' => array('template' => 'tpl/page_403' ),
        'page_404' => array('template' => 'tpl/page_404'),
    );
}
/**
 * Implements hook_permission().
 */
function Core_permission() {
  return array(
    'access protected Core' => array(
      'title' => t('Access protected Core'),
    ),
  );
}
/**
 * Implementation of hook_init().
 */
require_once 'autoload.php';

function Core_init(){
	drupal_add_library('system', 'ui.dialog');
	drupal_add_library('system', 'ui.datepicker');
    $param = arg();

    if(isset($param[0]) && $param[0] != 'admin'){
    	$files = array(
            //'bootstrap/js/bootstrap.min.js',
            'bootstrap/css/bootstrap.css',
            'css/font-awesome.css',
            'css/core.css',
    		'js/core.js',
            'js/jquery.alerts.js',

    	);
	    Loader::load('Core', $files);
        $files = array(
            'js/ckeditor/ckeditor.js',
            'js/ckeditor/config.js',

        );
        Loader::loadJSExt('Core', $files);
    }

    Session::setSessionAnonymousUserShop();
}
function page_403(){

   $view = theme('page_403');
	return $view;
}
function page_404(){

	$view = theme('page_404');
	return $view;
}
function CoreAjax(){
    global $base_url;

    $choice = array(
                "index" => "index",
                "upload_image" => "ajax_upload_image",
            );


    $action = FunctionLib::getParam('act', '');

    if (!isset($choice[$action])) {
        $choice[$action] = "index";
    }

    if($action != ''){
        $AjaxUpload = new AjaxUpload();
        $AjaxUpload->playme();
    }else{
        echo "Access denied!";
    }

}